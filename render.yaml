# Backend + DB (free) + Frontend (free) uchun render.yaml

services:
  # 1. Backend Xizmati (Node.js API serveri) — FREE
  - type: web
    name: tabletmenu-backend
    env: node
    plan: free          # Free tier
    rootDir: ./server
    buildCommand: npm install
    startCommand: node index.js
    envVars:
      # Neon Postgres connection string-ni bu yerga qo'yasan
      # Masalan: postgres://user:password@host/dbname
      - key: DATABASE_URL
        value: "POSTGRES_CONNECTION_STRING_BU_YERDA"

  # 2. Frontend Xizmati (React, statik) — FREE
  - type: web
    name: tabletmenu-frontend
    env: static
    plan: free          # Free tier
    rootDir: ./
    buildCommand: npm install && npm run build
    staticPublishPath: ./dist

    routes:
      # SPA router: barcha yo'llarni index.html'ga yuborish
      - type: rewrite
        source: /*
        destination: /index.html
